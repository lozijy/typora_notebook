## 原理

![image-20221031212832282](C:\Users\lonux\AppData\Roaming\Typora\typora-user-images\image-20221031212832282.png)

**贝叶斯认为待估计值的概率是随机的变量，而用来估计的数据反过来是确定的常数，讨论观测数据的概率分布才是没有意义的。**我们已知一系列的特征Bi来预测这个样本的种类A，所以我们的目的就是MaxP(A|B),而通过贝叶斯公式我们可以转换为MaxP(B|A)P(A),这里的P(A)就是每个种类发生的概率，称为先验概率(pri_prob)，而P(B|A)是已知样本的种类的情况下，特征为B的概率，称为后验概率(pos_prob).

### 代码讲解

1.采用的数据集是西瓜书84页列出的西瓜数据集，数据量比较小，仅有17个样本和8个特征(6个离散值，2个连续值)

```shell
编号,色泽,根蒂,敲声,纹理,脐部,触感,密度,含糖率,好瓜
1,青绿,蜷缩,浊响,清晰,凹陷,硬滑,0.697,0.46,是
2,乌黑,蜷缩,沉闷,清晰,凹陷,硬滑,0.774,0.376,是
3,乌黑,蜷缩,浊响,清晰,凹陷,硬滑,0.634,0.264,是
4,青绿,蜷缩,沉闷,清晰,凹陷,硬滑,0.608,0.318,是
5,浅白,蜷缩,浊响,清晰,凹陷,硬滑,0.556,0.215,是
6,青绿,稍蜷,浊响,清晰,稍凹,软粘,0.403,0.237,是
7,乌黑,稍蜷,浊响,稍糊,稍凹,软粘,0.481,0.149,是
8,乌黑,稍蜷,浊响,清晰,稍凹,硬滑,0.437,0.211,是
9,乌黑,稍蜷,沉闷,稍糊,稍凹,硬滑,0.666,0.091,否
10,青绿,硬挺,清脆,清晰,平坦,软粘,0.243,0.267,否
11,浅白,硬挺,清脆,模糊,平坦,硬滑,0.245,0.057,否
12,浅白,蜷缩,浊响,模糊,平坦,软粘,0.343,0.099,否
13,青绿,稍蜷,浊响,稍糊,凹陷,硬滑,0.639,0.161,否
14,浅白,稍蜷,沉闷,稍糊,凹陷,硬滑,0.657,0.198,否
15,乌黑,稍蜷,浊响,清晰,稍凹,软粘,0.36,0.37,否
16,浅白,蜷缩,浊响,模糊,平坦,硬滑,0.593,0.042,否
17,青绿,蜷缩,沉闷,稍糊,稍凹,硬滑,0.719,0.103,否
```





2.使用Pandas处理数据，便于进行数据整理与清洗，操作方便灵活。 

3.主要拆分成9个函数，使功能模块化，提高代码复用率

```python
def __init__(self)//初始化变量
```

```python
def load(self,path)//加载数据集，对不同的文本格式有不同的处理
```

```python
def discretization(self,col)//离散化
```

```python
def cal_pri_prob(self, col, category)//计算先验概率
	self.pri_prob1 = len(self.data[self.data[col] == category]) / len(self.data)
    self.pri_prob2 = len(self.data[self.data[col] == category]) / len(self.data)
```

```python
def cal_pos_prob(self, lable, col2, category)//计算后验概率
```

```python
def init2(self, lable, category)//计算先验概率并初始化
```

```python
def fit(self, class2, lable1, lable2)//class2表示我们要对什么类型进行判断，比如我们已经知道它是一个好瓜和一些其他的特征，来判断颜色等等，可以给用户更高的自由度
```

```python
def pridict(self)
```

```python
def main(self)
```

4.不足:由于是西瓜书上的内容，数据量较小且没有测试集，所以未做数据预处理和拉普拉斯平滑，且无法判断训练后预测的正确率